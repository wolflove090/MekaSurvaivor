---
name: diff-understanding-share
description: origin/main との差分を把握し、対応内容を output/ 配下へ整理し、ユーザーに分かりやすく段階共有するためのスキル。差分レビューや実装報告を小さな塊で説明したいときに使う。ユーザーが $diff-understanding-share を明示的に指定した場合にのみ使う。
---

# Diff Understanding Share

以下を順番に実行する。順序を入れ替えない。

## 0. 実行前提の確認

- 明示呼び出しで開始する。自動で開始しない。
- 作業ディレクトリが Git リポジトリであることを確認する。
- `origin/main` が参照可能か確認する。必要なら `git fetch origin main` を提案する。

## 1. origin/main との差分を把握

- まず全体像を把握する。
  - 変更ファイル一覧
  - 追加/削除行の規模
  - 変更タイプ（機能追加、修正、リファクタ、ドキュメントなど）
- 次に詳細を読む。
  - 重要度が高い差分から優先して確認
  - 目的、変更内容、影響範囲、懸念点を抽出
- 推測は断定しない。不明点は「要確認」として明示する。

## 2. 対応内容を output/ に出力

- `output/` がなければ作成する。
- 差分要約ファイルを作成する。ファイル名は次の形式でなければ作成する。
  - `output/diff-summary.md`
- 要約には最低限以下を含める。
  - 対象ブランチと比較対象（`origin/main`）
  - 変更サマリ（件数、主要カテゴリ）
  - 対応内容の詳細（目的/変更点/影響範囲/確認事項）
  - ユーザー向け説明を分割するための塊定義

## 3. ユーザーへの段階共有

- 説明の最初に、差分の概要を必ず共有する。
  - 変更ファイル数、追加/削除行数、主要な変更トピックを短く示す。
- 一度に全量を説明しない。塊ごとに説明する。
- 1塊の目安
  - 1〜3ファイル
  - または単一トピック（例: 入力処理、UI、データ保存）
- 各塊では、コード差分を `git diff` と同じ形式で説明する。
  - ```diff` コードブロックを使う。
  - `diff --git` / `---` / `+++` / `@@` / `+` / `-` を含める。
  - 実コード全量ではなく、意図が伝わる最小限のハンクを抜粋する。
- 各塊では以下を簡潔に伝える。
  - `git diff` 形式で何を変えたか
  - なぜ変えたか
  - ユーザー影響
  - 懸念点や確認ポイント

## 4. 塊ごとの確認ゲート

- 各塊の説明後、必ずユーザー確認を取る。
- 確認が取れるまで次の塊へ進まない。
- 確認文は毎回明示する。
  - 例: `次の塊に進んでよいですか？（はい / いいえ / 修正希望）`
- `修正希望` の場合は、その塊の説明を調整して再提示する。

## 5. 出力と会話の整合

- `output/` に書いた内容と会話で共有する内容を一致させる。
- 追加で判明した事項があれば、`output/` の要約も更新する。
- 最後に、未確認事項と次アクションを短く整理する。

## 6. 説明完了後の差分要約出力

- 全塊の説明と確認が完了した後、最終的な差分要約を必ず表示する。
- 最終要約には最低限以下を含める。
  - 差分全体の要点（3〜5項目）
  - 主要な変更ファイルと変更理由
